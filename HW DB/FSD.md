<table width="1000" border="1">
<thead>
  <tr>
    <td rowspan="3"><img width="300px" src="https://github.com/vnukov-vv/AlfaCampus-SA/assets/101928718/6c8664d3-2b42-4c23-9b08-686f390ca366"></td>
    <td colspan="2" width="700"><p align="center"><b>Cтруктура БД для сервиса «Доставка заказа карт»</b></p></td>
  </tr>
  <tr>
    <td>Дата</td>
    <td>15.01.2024</td>
  </tr>
  <tr>
    <td>Версия</td>
    <td>1.1</td>
  </tr>
</thead>
</table>

# Cтруктура БД для сервиса «Доставка заказа карт».

## Оглавление
[1. Требования к Системе](#title1) <br> 
&nbsp; [1.1 Термины и определения](#title1_1) <br>
&nbsp; [1.2 Функциональные требования к Системе](#title1_2) <br>
[2. Структура БД](#title2)</br>
[3. Описание БД](#title3)</br>
&nbsp; [3.1 Таблицы БД](#title3_1) <br>
&nbsp; [3.2 Описание таблиц БД](#title3_2) <br>
<br>
[Пояснительная записка](#title4)</br>


## <a id="title1"> 1. Требования к Системе </a>
### <a id="title1_1"> 1.1. Термины и определения </a>
|Термин	|Определение|
|---|---|
|**Доставка**	|Комплекс мероприятий, осуществляемых для передачи **Карты** **Клиенту**|
|**Карта**	|Банковская карта (расчетная, кредитная) на физическом носителе выпущенная на имя конкретного **Клиента**, либо неперсонифицированная.|
|**Клиент**	|физическое лицо на имя которого в **Банке** открыт счёт и выпущена **Карта**|
|**Курьер**	|Физическое лицо осуществляющее доставку **Карты**|
|**Система**	|Комплекс программного и технического обеспечения предназначенный для поддержки бизнес-процессов **Банка**|
|**Пользователь**	|Физическое лицо имеющее доступ к **Системе** и обладающий правами на отображение и/или изменение данных|

### <a id="title1_2"> 1.2 Функциональные требования к Системе </a>

- **Курьер** должен иметь возможность авторизации в **Системе** как пользователь.
- **Курьер** должен иметь возможность просмотра в **Системе**:
    - Списка заданий на **Доставку** содержащих в т.ч. реквизиты **Карты**, **Клиента** и атрибуты **Встречи**).
- **Курьер** должен иметь возможность изменять следующие атрибуты:
    - атрибуты **Встречи** (Время, Место, Контактные данные **Клиента**)
    - статус **Доставки** (Завершена, Отменена или Неуспешна)

## <a id="title2"> 2. Структура БД **ParcelDelivery** </a>

[ParcelDelivery.drawio.xml](https://github.com/vnukov-vv/AlfaCampus-SA/blob/main/HW%20DB/ParcelDelivery.drawio.xml)

![](https://github.com/vnukov-vv/AlfaCampus-SA/blob/main/HW%20DB/ParcelDelivery.drawio.png)

## <a id="title3"> 3. Описание схемы БД **ParcelDelivery** </a>

База данных предназначена для автоматизации процессов доставки Карт с возможностью расширения до *«Доставки любых банковских продуктов»* 

### <a id="title3_1">Таблицы БД **ParcelDelivery**</a>
|№ |Имя|Описание| 
|---|---|---|
|1|pd.users|Пользователи **Системы**|
|2|pd.employees|Сотрудники **Курьеры**|
|3|pd.parcels|Заказы на **Доставку**|
|4|pd.statuses|Статусы **Доставки**|
|5|pd.subjects|Уникальный идентификатор **Карты** или другого банковского продукта|
|6|pd.shippings|Атрибуты (адрес) **Встречи**|
|7|pd.clients|Персональные данные **Клиента**|
|8|pd.contacts|Контактные данные **Клиента**|
|9|pd.products|Справочник банковских продуктов для **Доставки**|

### <a id="title3_2">Описание таблиц БД **ParcelDelivery**</a>
#### Таблица1
##### Колонки
|№ |Имя|Тип<br>данных|Размер|Обязательное<br>(Да/Нет)|Описание|
|---|---|---|---|---|---|
|---|---|---|---|---|---|
##### Ключи
|Тип|Имя ключа|Поле|Описание| 
|---|---|---|---|
|---|---|---|---|
##### Индексы
|Имя|Детали|Ключи|Описание| 
|---|---|---|---|
|---|---|---|---|

## <a id="title4"> Пояснительная записка </a>

При проектировании я исходил из того, что Сервис будет интегрироваться с уже существующими,
когда часть необходимых данных для отображения берется из других БД или же ссылается на них (см. **PlasticOrder**). Такие атрибуты выделены красным цветом на схеме. 

В любом случае **Доставка** привязывается к заказу **Карты** при этом для курьерской доставки выделяется отдельный **idDepartment** (ID отделения выдачи карты).

В самом упрощенном варианте **Система** может работать непосредственно с БД **PlasticOrder**. Для этого в БД необходимо добавить две таблицы **Shippings** (Адрес курьерской доставки) и **Сontacts** (Контактные данные) т.к. в "анкете" и "заказе" БД **PlasticOrder** эти атрибуты отсутствуют. **Сontacts** выносим в отдельную таблицу т.к. они могут не совпадать с указанными в Анкете **Клиента** (временный телефон **Клиента** или телефон места его временного пребывания).

Чтобы иметь возможность группировать разные заказы (например две разных карты) в одну доставку, добавлена отдельная сущность **Parcel** ("Посылка").

**Users** и **Employees** разнесены в т.ч. в целях упрощенного администрирования. Для ограничения доступа достаточно просто удалить строку в **Users**. При этом информация о **Курьере** останется в **Employees**, равно как не будут затронуты остальные данные БД.

Для отображения состава заказа в целях его однозначной идентификации (в нашем случае это должен быть уникальный атрибут **Name** - PAN **Карты**) добавлена таблица **Subjects**.

Расширение функциональности **Cистемы** до возможности *«Доставки любых банковских продуктов»* решается добавлением в схему таблицы **Products**, а в таблицу **Subjects** атрибута **Product_ID**. Новые продукта могут добавляться в этот справочник или импортироваться из существующего, а в качестве значения атрибута **idOrder** использовать аналогичный идентификатор из БД заказа банковского продукта.  






